# troff и nroff

__troff__ и __nroff__ - это системы для форматирования текстов, состоят из программ
форматирования и языка разметки. Принимают на вход текст с макросами и
директивами разметки и выдают на выход преобразованных текст.

nroff позволяет решать многие задачи форматирования путем программирования на
языке nroff.

troff - расширенный nfoff. Он может поддерживать множество символов,
разнообразные шрифты, организацию полей, сносок и т.п. nroff игнорирует
команды, которые может выполнить.

# процедура входа пользователя в систему

После включение компьютера производится проверка аппаратной части, после которой BIOS считывает из первого сектора загрузочного диска программу, которая запускаят основной загрузчик.
Производится загрузка в память ядра системы и запускается процесс `init`. Одна из функций, которую выполняет `init` - запускает шесть виртуальных консолей (процессов getty), чтобы предоставить пользователям возможность регистрироваться в системе с терминалов. 

1. процесс getty ожидает реакции пользователя на одной из терминальных линий, в случае активности пользователя выводит приглашение
2. после ввода имени пользователя запускается программа login, которая проверяет подлинность пользователя. Стандартным механизмом является проверка пароля, заданного для данного пользователя
3. убедившись, что пароль введён правильно, login запускает командный интерпретатор с установленными UID и GID данного пользователя.

При работе по сети роль getty исполняет сетевой демон, например ssh.

Все данные о пользователях UNIX хранит в файле /etc/passwd в текстовом виде. Каждому пользователю соответствует одна строка, поля которой разделяются двоеточиями:

```
входное имя:x:UID:GID:полное имя:домашний каталог:стартовый shell
```

Пароли на вход в систему пользователей в UNIX не хранятся в открытом виде, хранятся только их хеши, или же хеши вообще хранятся в спациальном файле, доступ к которому разрешен только системе, так что перебор вообще не возможен.

Последовательность событий при полной регистрации:

1. Пользователь вводит регистрационное имя по приглашению login: процесса getty.

2. getty выполняет программу login, используя в качестве аргумента указанное имя.

3. login запрашивает пароль и сверяет имя и пароль с записанными в файле /etc/passwd.

4. login выводит на экран из файла /etc/motd сообщение, выдаваемое после входа в систему.

5. login запускает интерпретатор shell, указанный в бюджете пользователя и устанавливает переменную среды TERM.

6. shell выполняет соответствующие файлы запуска, после чего выводит на экран приглашение и ожидает ввода информации.

# назначение утилиты getty

`getty` обеспечивает появление приглашений для login'a в консолях. init-системы настроены на запуск фиксированного
числа экземпляров getty, как правило, шести. Каждый getty-процесс устанавливает свою группу процессов, используя 
вызов системной функции setpgrp, открывает отдельную терминальную линию и обычно приостанавливается во время 
выполнения функции open до тех пор, пока машина не получит аппаратную связь с терминалом.

Когда функция open возвращает управление, getty выводит на дисплей из /etc/gettydefs входное сообщения. Потом 
getty считывает входное имя пользователя и вызывает команду login с именем пользователя в качестве аргумента,
которая требует от пользователей, чтобы они идентифицировали себя указанием регистрационного имени и пароля. 
Если пользователь зарегистрировался/залогинился успешно, запускается shell. Если пользователь не смог успешно 
зарегистрироваться, программа завершается, закрывая открытую терминальную линию, а процесс init порождает 
для этой линии следующий getty-процесс, открывающий терминал, вместо прекратившего существование.

p.s. изначально getty открывает 6 консолей, переключаться между ними можно с помощтю клавиш `ALT-F1 .... ALT-F6`,
но на самом деле, для пользователя не обязательно иметь все эти терминальные линии, чтобы сократить число 
терминальных линий достаточно закомментировать "лишние" строки в файле /etc/inittab

# отличиу файлов .profile и .kshrc

# ключи man
